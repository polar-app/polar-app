
function hasUserGroup() {
    return exists(/databases/$(database)/documents/user_group/$(request.auth.uid));
}

function getUserGroup() {
    return get(/databases/$(database)/documents/user_group/$(request.auth.uid));
}

function isPermittedGroupWithinSet(allowedGroups, groups) {
    return allowedGroups != null && allowedGroups.hasAny(groups);
}

function isPermittedGroup(groupID) {
    return hasUserGroup() &&
           isPermittedGroupWithinSet(getUserGroup().data.groups, [groupID]) ||
           isPermittedGroupWithinSet(getUserGroup().data.invitations, [groupID]);
}

/**
 */
function isPermittedGroups(groups) {
    return hasUserGroup() &&
           isPermittedGroupWithinSet(getUserGroup().data.groups, groups) ||
           isPermittedGroupWithinSet(getUserGroup().data.invitations, groups);
}
