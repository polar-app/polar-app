<div class="related-posts mt-4">

    <div class="text-center mt-2 mb-3 text-muted">
        <h2>Related Posts</h2>
    </div>

    <!--| where_exp:"post", "post.url != page.url"-->


    {% assign top_posts = site.posts | where_exp:"post", "post.layout == 'post'" | where_exp:"post", "post.permalink != '/blog/index.html'" | where_exp:"post", "post.url != page.url" | sort:"pinned" | reverse %}

    {%- if top_posts.size > 0 -%}

    <div class="post-list">

        <!--https://stackoverflow.com/questions/12655109/limit-the-number-of-post-though-a-category-with-jekyll-->

        {%- for post in top_posts limit: 3 -%}
        <div class="">
            <div class="card m-1" style="">

                <div class="card-body">

                    <a href="{{ post.url }}">
                        <h5 class="card-title">{{ post.title | escape }}</h5>
                    </a>

                    <p class="card-text">
                        {{ post.content | strip_html | truncatewords: 40 }}
                    </p>

                    {%- if post.large_image && post.large_image != "" -%}

                    <div class="p-1">
                        <a href="{{ post.url }}">
                            <img class="card-img-top" src="{{ post.large_image }}" alt="{{ post.title | escape }}">
                        </a>
                    </div>

                    {%- endif -%}

                </div>

            </div>
        </div>

        {%- endfor -%}

   </div>

    {%- endif -%}

</div>
