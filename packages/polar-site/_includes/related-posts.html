<div class="related-posts">

    <div class="text-center mt-2 mb-2 text-muted">
        <h4>Related Posts</h4>
    </div>

    <!--| where_exp:"post", "post.url != page.url"-->

    {% assign top_posts = site.posts | where_exp:"post", "post.layout == 'post'" | where_exp:"post", "post.permalink != '/blog/index.html'" | where_exp:"post", "post.url != page.url" %}

    {%- if top_posts.size > 0 -%}

    <div class="post-list">
    <div class="container">
    <div class="row">

        <!--https://stackoverflow.com/questions/12655109/limit-the-number-of-post-though-a-category-with-jekyll-->

        {%- for post in top_posts limit: 3 -%}
        <div class="col-lg-4">
        <div class="card m-1" style="">

            {%- if post.large_image && post.large_image != "" -%}

            <a href="{{ post.url }}">
                <img class="card-img-top" src="{{ post.large_image }}" alt="{{ post.title | escape }}">
            </a>

            {%- endif -%}


            <div class="card-body">
                <a href="{{ post.url }}">
                    <h5 class="card-title">{{ post.title | escape }}</h5>
                </a>

                <p class="card-text">
                    {{ post.content | strip_html | truncatewords: 40 }}
                </p>

            </div>

        </div>
        </div>

        {%- endfor -%}

    </div>
    </div>
    </div>

    {%- endif -%}

</div>
